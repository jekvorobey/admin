# Исходный код

## Страницы

Директория **pages**.

Под каждую страницу выделяется отдельная папка. Внутри папки идут 3 файла: js, hbs и css. Названия файлов и название директории должны совпадать и обозначать имя страницы, т.к. сборщик ожидает увидеть именно такую структуру.

В многостраничном приложении точкой входа для Webpack служит страница, а точнее js-файл страницы. Соответственно всё, что должно попасть на страницу, должно быть напрямую импортировано в этот файл.

Единственным обязательным импортом является

```js
import '../../scripts/common';
```

Все остальные модули нужно подключать по мере необходимости.

## Компоненты

Директория **blocks**.

Компоненты - это комплексные блоки, предназначенные для повторного использования. Самые сложные общие компоненты уже реализованы в бланке, но на проектах эта коллекция должна дополняться своими частными компонентами. В виде компонента имеет смысл оформлять любые цельные блоки, которые будут использованы несколько раз и могут принимать параметры для вариативного изменения. Впрочем, если блок используется только на одной странице, то его имеет смысл оформлять как компонент, если он комплексный.

В простейшем случае компонент - это директория с 3 файлами: js, hbs и сss. Аналогично страницам, называться они все должны по имени компонента. В js определяется класс компонента, в hbs - шаблон, в css - стили.

### Скрипт

Даже пустой компонент должен иметь несколько обязательных полей и методов, позволяющих его создавать и удалять:

1. **constructor**. Здесь определяется \$block - ссылка на jQuery-обёртку соответствующего компоненту DOM-элемента, elements - список ссылок на элементы блока, к которым можно обращаться через js. Если компонент имеет параметры, то здесь происходит сохранение их в поля.
1. **create**. Статический метод, в котором происходит создание экземпляров класса для соответствующих элементов страницы и добавления их в коллекцию.
1. **remove**. Статический метод, в котором происходит удаление объекта из коллекции.
1. **instances**. Статическое поле, в котором хранится коллекция всех созданных объектов класса.
1. **getInstance**. Статический метод, возвращающий экземпляр класса из коллекции, соответствующий переданному DOM-элементу (jQuery-обёртке).

### Шаблоны

Шаблоны компонентов представляют собой основную разметку блока. В шаблон могут передаваться параметры, которые записываются в data-атрибуты блока. Затем в методе create() эти атрибуты парсятся и заносятся в объект в форме полей класса. Такой подход позволяет настраивать параметры прямо из разметки, что важно при текущем подходе к интеграции.

Помимо основного шаблона могут быть определены и дополнительные. Например, это могут быть подшаблоны отдельных фрагментов компонента, которые подключаются через скрипт. Пример такого подхода есть в компоненте CustomFile. Другой случай - это использование контента внутри компонента. Такие подшаблоны вкладываются в папку templates и вызываются из основного шаблона. К таким компонентам можно отнести карусели, табы и аккордеоны.

### Стили

Файл со стилями содержит стилизацию блока по БЭМ. Если компонент использует внешнюю библиотеку, то переопределение её стилей идёт в отдельном файлу, названном по имени библиотеки. В этом файле рекомендуется соблюдать исходную структуру файла стилей библиотеки, которая может быть и не по БЭМ. Сохранение исходной структуры позволяет избавиться от длинных переопределений и излишних !important. Выделение в отдельный файл избавляет от вплетения в наши стили несоответствующих нашему стайлгайду селекторов.

Рекомендуется в рамках файла стилей определять CSS-переменные для лёгкого изменения в дальнейшем таких характеристик, как размеры элементов. Переменные помещаются в :root и используются только в этом файле. Формально, т.к. мы определили их в :root, то они являются глобальными, но на уровне договорённости мы считаем их локальными и не используем извне. Определять переменные вне :root внутри селекторов нельзя из-за особенностей сборки. Из-за возможного конфликта имён всем локальным переменным присваиваем префикс из имени компонента, в которым они используются в формате:

```css
:root {
    --<компонент>-<имя>: <значение>;
}
```

## Скрипты

Директория **scripts**.

Здесь прописываются скрипты общей направленности такие как валидация и маски. Такие скрипты обычно подключаются добавлением к элементам класса с префиксом js.

Также здесь хранятся различные переменные и хэлперы, которые можно использовать в компонентах и на страницах.

Отдельно стоит скрипт common.js - он включает в себя все базовые зависимости, которые должны быть подключены к каждой странице.

## Стили

Директория **styles**.

Здесь прописываются стили общей направленности, например стилизация тегов и базовых элементов вроде кнопок, ссылок, списков, таблиц и т.д.

Также здесь хранятся различные переменные и хэлперы, которые можно использовать в компонентах и на страницах.

Отдельно выделяются 3 файла: customProperties.css, customMedia.css и customSelectors.css. В них указываются CSS-переменные, медиазапросы и кастомные селекторы - PostCSS смотрит в эти файлы и делает их доступными на всём проекте (см. .postcssrc.js).

## Шаблоны

Директория **templates**.

Здесь хранятся хэлперы и паршлы Handlebars.

Хэлперы лежат в директории helpers. Это мини-функции, доступные для вставки в hbs-шаблоны.

Паршлы лежат в директории partials. Это немногочисленные шаблоны, неотносящиеся к конкретному компоненту.

## Изображения

Директория **images**.

**(!)** Подход к изображениям на данный момент не до конца определён.

svg-иконки, из которых генерируется спрайт, хранятся в папке sprite.

В папке responsive лежат изображения, которые импортируются в js и для которых генерируется оптимизированная версия.

Все остальные изображения лежат в корне - это svg, которые подгружаются через background, фавиконка и просто обычные изображения.

## Шрифты

Директория **fonts**.

Шрифты загружаются в форматах woff и woff2. Каждый шрифт хранится в отдельной папке.

Логика подгрузки шрифтов прописана в scripts/fonts.js, @font-face и присвоение font-family идёт в styles/fonts.css.
